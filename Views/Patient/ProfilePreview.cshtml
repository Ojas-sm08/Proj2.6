@model HospitalManagementSystem.Models.Patient // This view expects a Patient model, can be null for admin message
@{
    ViewData["Title"] = "Patient Profile Preview";
    Layout = "~/Views/Shared/_Layout.cshtml"; // Ensure it uses your main layout
}

<h2 class="mb-4">👤 Patient Profile Preview</h2>

@if (Model != null)
{
    <div class="card shadow-sm mb-4">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0">Patient Details</h5>
        </div>
        <div class="card-body">
            <h5 class="card-title text-primary">@Model.Name</h5>
            <dl class="row">
                <dt class="col-sm-4">Patient ID:</dt>
                <dd class="col-sm-8">@Model.PatientId</dd>

                <dt class="col-sm-4">Date of Birth:</dt>
                <dd class="col-sm-8">@Model.DateOfBirth.ToShortDateString()</dd>

                <dt class="col-sm-4">Gender:</dt>
                <dd class="col-sm-8">@Model.Gender</dd>

                <dt class="col-sm-4">Contact Number:</dt>
                <dd class="col-sm-8">@Model.ContactNumber</dd>

                <dt class="col-sm-4">Address:</dt>
                <dd class="col-sm-8">@Model.Address</dd>

                <dt class="col-sm-4">Medical History:</dt>
                <dd class="col-sm-8">@Model.MedicalHistory</dd>
            </dl>
        </div>
    </div>
    <div class="mt-3">
        <a asp-action="Edit" asp-route-id="@Model.PatientId" class="btn btn-primary">Edit Profile</a>
        <a asp-action="Manage" class="btn btn-secondary ms-2">Back to Patient List</a>

        @* This is the "Download PDF" button *@
        <a asp-controller="Patient" asp-action="DownloadProfilePdf" asp-route-id="@Model.PatientId" class="btn btn-info ms-2">
            <i class="bi bi-file-earmark-pdf"></i> Download PDF
        </a>
    </div>
}
else if (ViewBag.Message != null)
{
    <div class="alert alert-info">
        @ViewBag.Message
    </div>
    <div class="mt-3">
        <a asp-action="Manage" class="btn btn-primary">Go to Patient List</a>
    </div>
}
else
{
    <div class="alert alert-warning">
        No patient profile found to preview. Please select a patient or ensure you are logged in as a patient.
    </div>
    <div class="mt-3">
        <a asp-action="Manage" class="btn btn-primary">Go to Patient List</a>
    </div>
}

@section Scripts {
    <script>
        // Optional: Add some client-side script for PDF generation if using a client-side library,
        // but typically PDF generation is server-side.
    </script>
}